<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>docker | 久朝暮</title><meta name="keywords" content="docker"><meta name="author" content="久朝暮"><meta name="copyright" content="久朝暮"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="docker"><meta name="application-name" content="docker"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#ffffff"><meta property="og:type" content="article"><meta property="og:title" content="docker"><meta property="og:url" content="https://gaoyubo.cn/blogs/f255ffad.html"><meta property="og:site_name" content="久朝暮"><meta property="og:description" content="初始Docker 我们写的代码会接触到好几个环境：开发环境、测试环境以及生产环境 Docker概念  Docker是一个开源的应用容器引擎 Docker可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的Linux机器上 容器是完全使用沙箱机制，相互隔离"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg"><meta property="article:author" content="久朝暮"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg"><meta name="description" content="初始Docker 我们写的代码会接触到好几个环境：开发环境、测试环境以及生产环境 Docker概念  Docker是一个开源的应用容器引擎 Docker可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的Linux机器上 容器是完全使用沙箱机制，相互隔离"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://gaoyubo.cn/blogs/f255ffad"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: undefined,
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🔨 设计开发一条龙","🏃 脚踏实地行动派","👆🏻 专注C++开发"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 久朝暮","link":"链接: ","source":"来源: 久朝暮","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '久朝暮',
  title: 'docker',
  postAI: '',
  pageFillDescription: '初始Docker, Docker概念, 安装Docker, Docker 架构, Docker命令, Docker服务相关命令, Docker镜像相关命令, Docker容器相关命令, Docker容器的数据卷, 数据卷概念, 数据卷, 数据卷作用, 配置数据卷, 数据卷容器, 配置数据卷容器, Docker应用部署, MySQL部署, Tomcat部署, Nginx部署, Redis部署, Dockerfile, Docker镜像原理, 镜像制作, Dockerfile概念, 关键字, Docker服务编排, Docker Compose, 安装Docker Compose, 卸载Docker Compose, Docker私有仓库, 私有仓库搭建, 将镜像上传至私有仓库, 从私有仓库拉取镜像, docker容器虚拟化与传统虚拟机比较初始我们写的代码会接触到好几个环境开发环境测试环境以及生产环境概念是一个开源的应用容器引擎可以让开发者打包他们的应用以及依赖包到一个轻量级可移植的容器中然后发布到任何流行的机器上容器是完全使用沙箱机制相互隔离容器性能开销极低是一种容器技术解决软件跨环境迁移的问题安装可以运行在等操作系统上以为例官网包更新到最新安装需要的软件包提供功能另外两个是驱动依赖的设置源安装出现输入的界面都按查看版本验证是否验证成功架构镜像镜像就相当于是一个文件系统容器镜像和容器的关系就像是面向对象程序设计中的类和对象一样镜像是静态的定义容器是镜像运行时的实体容器可以被创建启动停止删除暂停等仓库仓库可看成一个代码控制中心用来保存镜像命令服务相关命令启动服务停止服务重启服务查看服务状态设置开机启动服务镜像相关命令查看镜像查看本地所有的镜像查看所用镜像的搜索镜像从网络中查找需要的镜像镜像名称拉取镜像从仓库下载镜像到本地镜像名称格式为名称版本号如果版本号不指定则是最新的版本如果不知道镜像版本可以去搜索对应镜像查看镜像名称删除镜像删除本地镜像镜像删除指定本地镜像删除所有本地镜像容器相关命令查看容器查看正在运行的容器查看所有容器创建并启动容器参数参数说明保持容器运行通常与同时使用加入这两个参数后容器创建后自动进入容器中退出容器后容器自动关闭为容器重新分配一个伪输入终端通常与同时使用以守护后台模式运行容器创建一个容器在后台运行需要使用进入容器退出后容器不会关闭创建的容器一般称为交互式容器创建的容器一般称为守护式容器为创建的容器命名进入容器参数退出容器容器不会关闭停止容器容器名称启动容器容器名称删除容器如果容器是运行状态则删除失败需要停止容器才能删除容器名称查看容器信息容器名称容器的数据卷数据卷概念思考容器删除后在容器中产生的数据也会随之销毁容器和外部机器可以直接交换文件吗容器之间想要进行数据交互数据卷数据卷是宿主机中的一个目录或文件当容器目录和数据卷目录绑定后对方的修改会立即同步一个数据卷可以被多个容器同时挂载一个容器也可以被挂载多个数据卷数据卷作用容器数据持久化外部机器和容器间接通信容器之间数据交换配置数据卷创建启动容器时使用参数设置数据卷宿主机目录文件容器内目录文件注意事项目录必须是绝对路径如果目录不存在会自动创建可以挂载多个数据卷数据卷容器多容器进行数据交换多个容器挂载同一个数据卷数据卷容器配置数据卷容器创建启动数据卷容器使用参数设置数据卷创建启动容器使用参数设置数据卷应用部署部署容器内的网络服务和外部机器不能直接通信外部机器和宿主机可以直接通信宿主机和容器可以直接通信当容器中的网络服务需要被外部机器访问时可以将容器中提供服务的端口映射到宿主机的端口上外部机器访问宿主机的该端口从而间接访问容器的服务这种操作称为端口映射搜索镜像拉取镜像创建容器设置端口映射目录映射在目录下创建目录用于存储数据信息暴露端口映射宿主机容器参数说明将容器的端口映射到宿主机的端口一般不修改宿主机端口就是将主机当前目录下的挂载到容器的配置目录将主机当前目录下的目录挂载到容器的日志目录将主机当前目录下的目录挂载到容器的数据目录初始化用户的密码进入容器操作部署搜索镜像拉取镜像创建容器设置端口映射目录映射在目录下创建目录用于存储数据信息参数说明将容器的端口映射到主机的端口将主机中当前目录挂载到容器的部署搜索镜像拉取镜像创建容器设置端口映射目录映射在目录下创建目录用于存储数据信息在下创建文件粘贴下面内容参数说明将容器的端口映射到宿主机的端口将主机当前目录下的挂载到容器的配置目录将主机当前目录下的目录挂载到容器的日志目录部署搜索镜像拉取镜像创建容器设置端口映射使用外部机器连接主机地址操作系统组成部分进程调度子系统进程通信子系统内存管理子系统设备管理子系统文件管理子系统网络通信子系统作业控制子系统文件系统由和两部分组成包含引导加载程序和内核文件系统包含的就是典型系统中的等标准目录和文件不同的发行版基本一样而不同如等镜像原理总结就是复用镜像是由特殊的文件系统叠加而成最底端是并使用宿主机的第二层是文件系统称为然后再往上可以叠加其他的镜像文件统一文件系统技术能够将不同的层整合成一个文件系统为这些层提供了一个统一的视角这样就隐藏了多层的存在在用户的角度看来只存在一个文件系统一个镜像可以放在另一个镜像的上面位于下面的镜像称为父镜像最底部的镜像成为基础镜像当从一个镜像启动容器时会在最顶层加载一个读写文件系统作为容器思考镜像本质是什么是一个分层文件系统中一个镜像为什么只有而一个操作系统的文件要几个的镜像文件包含和而的镜像复用操作系统的只有和其他镜像层中一个镜像为什么有而一个安装包只有多由于中镜像是分层的虽然只有多但他需要依赖于父镜像和基础镜像所有整个对外暴露的镜像大小多镜像制作镜像如何制作容器转为镜像容器镜像名称版本号将容器转为新的镜像不是目录挂载的都可以生效压缩文件名称镜像名称版本号将新的镜像打包成压缩文件进行传输压缩文件名称将压缩文件解压还原为镜像概念是一个文本文件包含了一条条的指令每一条指令构建一层基于基础镜像最终构建出一个新的镜像对于开发人员可以为开发团队提供一个完全一致的开发环境对于测试人员可以直接拿开发时所构建的镜像或者通过文件构建一个新的镜像开始工作了对于运维人员在部署时可以实现应用的无缝移植网址关键字关键字作用备注指定父镜像指定基于那个构建作者信息用来标明这个作者标签用来标明的标签可以使用代码最终都是在基本信息中可以查看执行命令执行一段命令默认是格式或者容器启动命令启动容器时候的默认命令和配合使用格式或者复制文件的时候复制文件到中添加文件的时候添加文件到中不仅仅局限于当前的上下文可以来源于远程服务环境变量指定时候的环境变量可以在启动的容器的时候通过覆盖格式构建参数构建参数只在构建的时候使用的参数如果有那么的相同名字的值始终覆盖的参数定义外部可以挂载的数据卷指定的哪些目录可以启动的时候挂载到文件系统中启动容器的时候使用绑定格式目录暴露端口定义容器运行的时候监听的端口启动容器的时候使用来绑定暴露端口格式或者工作目录指定容器内部的工作目录如果没有创建则自动创建如果指定使用的是绝对地址如果不是开头那么是在上一条的路径的相对路径指定执行用户指定或者启动的时候用户在执行的时候的用户健康检查指定检测当前容器健康监测的命令基本上没用因为很多时候应用本身有健康监测机制触发器当存在关键字的镜像作为基础镜像的时候当执行完成之后会执行的命令但是不影响当前镜像用处也不怎么大发送信号量到宿主机该指令设置将发送到容器的系统调用信号以退出指定执行脚本的指定执行命令的时候使用的服务编排微服务架构的应用系统中一般包含若干个微服务每个微服务一般都会部署多个实例如果每个微服务都要手动启停维护的工作量会很大要从或者去拉取要创建多个要管理这些启动停止删除服务编排按照一定的业务规则批量管理容器是一个编排多容器分布式部署的工具提供命令集管理容器化应用的完整开发周期包括服务构建启动和停止使用步骤利用定义运行环境镜像使用定义组成应用的各服务运行启动应用安装目前已经完全支持和在我们安装之前需要先安装下面我们以编译好的二进制包方式安装在系统中设置文件可执行权限查看版本信息卸载二进制包方式安装的删除二进制文件即可私有仓库官方的是一个用于管理公共镜像的仓库我们可以从上面拉取镜像到本地也可以把我们自己的镜像推送上去但是有时候我们的服务器无法访问互联网或者你不希望将自己的镜像放到公网当中那么我们就需要搭建自己的私有仓库来存储和管理自己的镜像私有仓库搭建拉取私有仓库镜像启动私有仓库容器打开浏览器输入地址私有仓库服务器看到表示私有仓库搭建成功修改在上述文件中添加一个保存退出此步用于让信任私有仓库地址注意将私有仓库服务器修改为自己私有仓库服务器真实私有仓库服务器重启服务将镜像上传至私有仓库标记镜像为私有仓库的镜像私有仓库服务器上传标记的镜像私有仓库服务器从私有仓库拉取镜像拉取镜像私有仓库服务器容器虚拟化与传统虚拟机比较容器就是将软件打包成标准化单元以用于开发交付和部署容器镜像是轻量的可执行的独立软件包包含软件运行所需的所有内容代码运行时环境系统工具系统库和设置容器化软件在任何环境中都能够始终如一地运行容器赋予了软件独立性使其免受外在环境差异的影响从而有助于减少团队间在相同基础设施上运行不同软件时的冲突相同容器和虚拟机具有相似的资源隔离和分配优势不同容器虚拟化的是操作系统虚拟机虚拟化的是硬件传统虚拟机可以运行不同的操作系统容器只能运行同一类型操作系统特性容器虚拟机启动秒级分钟级硬盘使用一般为一般为性能接近原生弱于系统支持量单机支持上千个容器一般几十个',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-17 21:35:41',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">久朝暮</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/album/"><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/wechat.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/wechat.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/alipay.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C-STL/" style="font-size: 1.05rem;">C++ STL<sup>1</sup></a><a href="/tags/C-2-0/" style="font-size: 1.05rem;">C++2.0<sup>1</sup></a><a href="/tags/C-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 1.05rem;">C++内存管理<sup>1</sup></a><a href="/tags/C-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 1.05rem;">C++设计模式<sup>1</sup></a><a href="/tags/C-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/" style="font-size: 1.05rem;">C++面向对象高级编程<sup>1</sup></a><a href="/tags/Effective-C/" style="font-size: 1.05rem;">Effective C++<sup>1</sup></a><a href="/tags/Linux%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/" style="font-size: 1.05rem;">Linux常用函数<sup>1</sup></a><a href="/tags/Linux%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">Linux系统命令<sup>1</sup></a><a href="/tags/UCAS%E8%AF%BE%E7%A8%8B/" style="font-size: 1.05rem;">UCAS课程<sup>4</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>1</sup></a><a href="/tags/%E7%A7%BB%E5%8A%A8%E4%BA%92%E8%BF%9E%E7%BD%91%E6%8A%80%E6%9C%AF/" style="font-size: 1.05rem;">移动互连网技术<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">8</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/docker/" itemprop="url">docker</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/docker/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>docker</span></a></span></div></div><h1 class="post-title" itemprop="name headline">docker</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-03-16T03:11:46.000Z" title="发表于 2024-03-16 11:11:46">2024-03-16</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-03-17T13:35:41.131Z" title="更新于 2024-03-17 21:35:41">2024-03-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">4.4k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://gaoyubo.cn/blogs/f255ffad.html"><header><a class="post-meta-categories" href="/categories/docker/" itemprop="url">docker</a><a href="/tags/docker/" tabindex="-1" itemprop="url">docker</a><h1 id="CrawlerTitle" itemprop="name headline">docker</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">久朝暮</span><time itemprop="dateCreated datePublished" datetime="2024-03-16T03:11:46.000Z" title="发表于 2024-03-16 11:11:46">2024-03-16</time><time itemprop="dateCreated datePublished" datetime="2024-03-17T13:35:41.131Z" title="更新于 2024-03-17 21:35:41">2024-03-17</time></header><h1 id="初始docker">初始Docker</h1>
<p>我们写的代码会接触到好几个环境：开发环境、测试环境以及生产环境</p>
<h2 id="docker概念">Docker概念</h2>
<ul>
<li>Docker是一个开源的应用容器引擎</li>
<li>Docker可以让开发者打包他们的应用以及依赖包到一个轻量级、可移植的容器中，然后发布到任何流行的Linux机器上</li>
<li>容器是完全使用沙箱机制，相互隔离</li>
<li>容器性能开销极低</li>
</ul>
<blockquote>
<p>Docker是一种容器技术，解决软件跨环境迁移的问题</p>
</blockquote>
<h2 id="安装docker">安装Docker</h2>
<p>Docker可以运行在MAC、Windows、CentOS、UBUNTU等操作系统上。以centos7为例。</p>
<p>Docker。官网：<a target="_blank" rel="noopener" href="https://www.docker.com">https://www.docker.com</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1、yum包更新到最新</span></span><br><span class="line">yum update</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2、安装需要的软件包，yum-util提供yum-config-manager功能，另外两个是devicemapper驱动依赖的</span> </span><br><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3、设置yum源</span></span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">4、安装docker，出现输入的界面都按y</span></span><br><span class="line">yum install -y docker-ce</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">5、查看docker版本，验证是否验证成功</span></span><br><span class="line">docker -v</span><br></pre></td></tr></table></figure>
<h2 id="docker-架构">Docker 架构</h2>
<ul>
<li><strong>镜像</strong>（lmage)：Docker镜像（Image），就相当于是一个root文件系统。</li>
<li><strong>容器</strong>（Container）：镜像（Image）和容器（Container）的关系，就像是面向对象程序设计中的类和对象一样，镜像是静态的定义，容器是镜像运行时的实体。容器可以被创建、启动、停止、删除、暂停等。</li>
<li><strong>仓库</strong>（Repository）：仓库可看成一个代码控制中心，用来保存镜像。</li>
</ul>
<h1 id="docker命令">Docker命令</h1>
<h2 id="docker服务相关命令">Docker服务相关命令</h2>
<ul>
<li>启动docker服务</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>
<ul>
<li>停止docker服务：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>
<ul>
<li>重启docker服务:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>
<ul>
<li>查看docker服务状态：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status docker</span><br></pre></td></tr></table></figure>
<ul>
<li>设置开机启动docker服务：</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker</span><br></pre></td></tr></table></figure>
<h2 id="docker镜像相关命令">Docker镜像相关命令</h2>
<ul>
<li>查看镜像：查看本地所有的镜像</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">docker images -q <span class="comment"># 查看所用镜像的id</span></span><br></pre></td></tr></table></figure>
<ul>
<li>搜索镜像：从网络中查找需要的镜像</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search 镜像名称</span><br></pre></td></tr></table></figure>
<ul>
<li>拉取镜像：从Docker仓库下载镜像到本地，镜像名称格式为名称：版本号，如果版本号不指定则是最新的版本。如果不知道镜像版本，可以去dockerhub搜索对应镜像查看。</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull 镜像名称</span><br></pre></td></tr></table></figure>
<ul>
<li>删除镜像：删除本地镜像</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rmi 镜像id <span class="comment"># 删除指定本地镜像</span></span><br><span class="line">docker rmi `docker images -q` <span class="comment"># 删除所有本地镜像</span></span><br></pre></td></tr></table></figure>
<h2 id="docker容器相关命令">Docker容器相关命令</h2>
<ul>
<li>查看容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps #查看正在运行的容器</span><br><span class="line">docker ps -a #查看所有容器</span><br></pre></td></tr></table></figure>
<ul>
<li>创建并启动容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run 参数</span><br></pre></td></tr></table></figure>
<p>参数说明：</p>
<blockquote>
<p>-i：保持容器运行。通常与 -t 同时使用。加入 -it
这两个参数后，容器创建后自动进入容器中，退出容器后，容器自动关闭</p>
<p>-t：为容器重新分配一个伪输入终端，通常与-i同时使用</p>
<p>-d：以守护（后台）模式运行容器。创建一个容器在后台运行，需要使用
docker exec 进入容器。退出后，容器不会关闭</p>
<p>-it：创建的容器一般称为<strong>交互式容器</strong>，-id
创建的容器一般称为<strong>守护式容器</strong></p>
<p>--name：为创建的容器命名</p>
</blockquote>
<ul>
<li>进入容器</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> 参数 <span class="comment">#退出容器，容器不会关闭</span></span><br></pre></td></tr></table></figure>
<ul>
<li>停止容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器名称</span><br></pre></td></tr></table></figure>
<ul>
<li>启动容器</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器名称</span><br></pre></td></tr></table></figure>
<ul>
<li>删除容器：如果容器是运行状态则删除失败，需要停止容器才能删除</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器名称/id</span><br></pre></td></tr></table></figure>
<ul>
<li>查看容器信息</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器名称</span><br></pre></td></tr></table></figure>
<h1 id="docker容器的数据卷">Docker容器的数据卷</h1>
<h2 id="数据卷概念">数据卷概念</h2>
<p>思考：</p>
<ul>
<li>Docker容器删除后，在容器中产生的数据也会随之销毁</li>
<li>Docker容器和外部机器可以直接交换文件吗？</li>
<li>容器之间想要进行数据交互？</li>
</ul>
<h3 id="数据卷">数据卷</h3>
<ul>
<li>数据卷是宿主机中的一个目录或文件</li>
<li>当容器目录和数据卷目录绑定后，对方的修改会立即同步</li>
<li>一个数据卷可以被多个容器同时挂载</li>
<li>一个容器也可以被挂载多个数据卷</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/image-20240317135912464.png" alt="image-20240317135912464" style="zoom:67%;"></p>
<h3 id="数据卷作用">数据卷作用</h3>
<ul>
<li>容器数据持久化</li>
<li>外部机器和容器间接通信</li>
<li>容器之间数据交换</li>
</ul>
<h2 id="配置数据卷">配置数据卷</h2>
<ul>
<li>创建启动容器时，使用 -v 参数设置数据卷</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run ... -v 宿主机目录(文件):容器内目录(文件)...</span><br></pre></td></tr></table></figure>
<ul>
<li>注意事项：
<ul>
<li>目录必须是绝对路径</li>
<li>如果目录不存在，会自动创建</li>
<li>可以挂载多个数据卷</li>
</ul></li>
</ul>
<h2 id="数据卷容器">数据卷容器</h2>
<p>多容器进行数据交换</p>
<ul>
<li>多个容器挂载同一个数据卷</li>
<li>数据卷容器</li>
</ul>
<h3 id="配置数据卷容器">配置数据卷容器</h3>
<ul>
<li>创建启动 c3 数据卷容器，使用 -v 参数设置数据卷</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name=c3 -v/volume centos:7 /bin/bash</span><br></pre></td></tr></table></figure>
<ul>
<li>创建启动 c1c2 容器，使用 --volumes-from 参数设置数据卷</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --name=c1 --volumes-from c3 centos:7 /bin/bash</span><br><span class="line">docker run -it --name=c2 --volumes-from c3 centos:7 /bin/bash</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/image-20240317142555542.png" alt="image-20240317142555542" style="zoom: 50%;"></p>
<h1 id="docker应用部署">Docker应用部署</h1>
<h2 id="mysql部署">MySQL部署</h2>
<ul>
<li>容器内的网络服务和外部机器不能直接通信</li>
<li>外部机器和宿主机可以直接通信</li>
<li>宿主机和容器可以直接通信</li>
<li>当容器中的网络服务需要被外部机器访问时，可以将容器中提供服务的端口映射到宿主机的端口上。外部机器访问宿主机的该端口，从而间接访问容器的服务</li>
<li>这种操作称为：<strong>端口映射</strong></li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/image-20240317153826136.png" alt="image-20240317153826136" style="zoom: 50%;"></p>
<ul>
<li>搜索mysql镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search mysql</span><br></pre></td></tr></table></figure>
<ul>
<li>拉取mysql镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.6</span><br></pre></td></tr></table></figure>
<ul>
<li>创建容器，设置端口映射、目录映射</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在/root目录下创建mysql目录用于存储mysql数据信息</span></span><br><span class="line">mkdir ~/mysql</span><br><span class="line">cd ~/mysql</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -id \</span><br><span class="line">-p 3307:3306 \  # 暴露端口映射，宿主机3307，容器3306</span><br><span class="line">--name=c_mysql \</span><br><span class="line">-v $PWD/conf:/etc/mysql/conf.d \ </span><br><span class="line">-v $PWD/logs:/logs \  </span><br><span class="line">-v $PWD/data:/var/lib/mysql \ </span><br><span class="line">-e MYSQL_ROOT_PASSWORD=123456 \</span><br><span class="line">mysql:5.6</span><br></pre></td></tr></table></figure>
<ul>
<li>参数说明：
<ul>
<li><code>-p 3307:3306</code>：将容器的 3306 端口映射到宿主机的
3307端口，（一般不修改宿主机端口，就是3306）</li>
<li><code>-v $PWD/conf:/etc/mysql/conf.d</code>：将主机当前目录下的
conf/my.cnf 挂载到容器的 /etc/mysql/my.cnf。配置目录</li>
<li><code>-v $PWD/logs:/logs</code>：将主机当前目录下的 logs
目录挂载到容器的 /logs 。日志目录</li>
<li><code>-v $PWD/data:/var/lib/mysql</code>：将主机当前目录下的 data
目录挂载到容器的 /var/lib/mysql。数据目录</li>
<li><code>-e MYSQL_R0OT_PASSWORD=123456</code>：初始化r0ot用户的密码</li>
</ul></li>
<li>进入容器，操作mysql</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it c_mysq1 /bin/bash</span><br></pre></td></tr></table></figure>
<h2 id="tomcat部署">Tomcat部署</h2>
<ul>
<li>搜索tomcat镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search tomcat</span><br></pre></td></tr></table></figure>
<ul>
<li>拉取tomcat镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull tomcat</span><br></pre></td></tr></table></figure>
<ul>
<li>创建容器，设置端口映射、目录映射</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在/root目录下创建 tomcat 目录用于存储 tomcat 数据信息</span></span><br><span class="line">mkdir ~/tomcat</span><br><span class="line">cd ~/tomcat</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -id --name=c_tomcat \</span><br><span class="line">-p 8080:8080 \</span><br><span class="line">-v $PWD:/usr/local/tomcat/webapps \</span><br><span class="line">tomcat</span><br></pre></td></tr></table></figure>
<ul>
<li>参数说明
<ul>
<li><code>-p 8080:8080</code>：将容器的8080端口映射到主机的8080端口</li>
<li><code>-v $PWD:/usr/local/tomcat/webapps</code>：将主机中当前目录挂载到容器的
webapps</li>
</ul></li>
</ul>
<h2 id="nginx部署">Nginx部署</h2>
<ul>
<li>搜索nginx镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search nginx</span><br></pre></td></tr></table></figure>
<ul>
<li>拉取nginx镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure>
<ul>
<li>创建容器，设置端口映射、目录映射</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在/root目录下创建nginx目录用于存储nginx数据信息</span></span><br><span class="line">mkdir ~/nginx</span><br><span class="line">cd ~/nginx</span><br><span class="line">mkdir conf</span><br><span class="line">cd conf </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在~/nginx/conf/下创建nginx.conf文件，粘贴下面内容</span></span><br><span class="line">vim nginx.conf</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">user  nginx;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.1og warn;</span><br><span class="line">pid      /var/run/Mginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events  &#123;</span><br><span class="line">  worker_connections	1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http  &#123;</span><br><span class="line">  include			/etc/nginx/mime.types;</span><br><span class="line">  default_type	application/octet-stream;</span><br><span class="line">  log_format	main	&#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class="line">            &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class="line">            &#x27;&quot;$http-user-agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class="line">  access_log	/var/log/nginx/access.1og	main;</span><br><span class="line">  sendfile	on;</span><br><span class="line"><span class="meta prompt_">  #</span><span class="language-bash">tcp_nopush	on;</span></span><br><span class="line">  </span><br><span class="line">  keepalive_timeout	65;</span><br><span class="line"><span class="meta prompt_">  #</span><span class="language-bash">gzip	on;</span></span><br><span class="line">  include /etc/nginx/conf.d/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -id --name=c_nginx \</span><br><span class="line">-p 80:80\</span><br><span class="line">-v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf \</span><br><span class="line">-v $PWD/logs:/var/log/nginx \</span><br><span class="line">-v $PWD/html:/usr/share/nginx/html \</span><br><span class="line">nginx</span><br></pre></td></tr></table></figure>
<ul>
<li>参数说明：
<ul>
<li><code>-p 80:80</code>：将容器的 80端口映射到宿主机的 80端口。</li>
<li><code>-v $PWD/conf/nginx.conf:/etc/nginx/nginx.conf</code>：将主机当前目录下的
/conf/nginx.conf 挂载到容器的 :/etc/nginx/nginx.conf。配置目录</li>
<li><code>-v $PWD/logs:/var/log/nginx</code>：将主机当前目录下的 logs
目录挂载到容器的 /var/log/nginx 。日志目录</li>
</ul></li>
</ul>
<h2 id="redis部署">Redis部署</h2>
<ul>
<li>搜索redis镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search redis</span><br></pre></td></tr></table></figure>
<ul>
<li>拉取redis镜像</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull redis:5.0</span><br></pre></td></tr></table></figure>
<ul>
<li>创建容器，设置端口映射</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -id --name=c_redis -p 6379:6379 redis:5.0</span><br></pre></td></tr></table></figure>
<ul>
<li>使用外部机器连接redis</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-cli.exe -h 主机ip地址 -p 6379</span><br></pre></td></tr></table></figure>
<h1 id="dockerfile">Dockerfile</h1>
<p>操作系统组成部分：</p>
<ul>
<li>进程调度子系统</li>
<li>进程通信子系统</li>
<li>内存管理子系统</li>
<li>设备管理子系统</li>
<li><strong>文件管理子系统</strong></li>
<li>网络通信子系统</li>
<li>作业控制子系统</li>
</ul>
<p>Linux文件系统由 bootfs 和 rootfs 两部分组成：</p>
<ul>
<li>bootfs：包含 bootloader（引导加载程序）和kernel（内核)</li>
<li>rootfs：root 文件系统，包含的就是典型 Linux 系统中的
/dev，/proc，/bin，/etc等标准目录和文件</li>
<li>不同的 Linux 发行版，bootfs 基本一样，而 rootfs 不同，如
ubuntu，centos等</li>
</ul>
<h2 id="docker镜像原理">Docker镜像原理</h2>
<p>总结就是：<strong>复用</strong></p>
<ul>
<li>Docker镜像是由特殊的文件系统叠加而成</li>
<li>最底端是bootfs，并使用宿主机的bootfs</li>
<li>第二层是root文件系统rootfs，称为base
image然后再往上可以叠加其他的镜像文件</li>
<li>统一文件系统（UnionFileSystem）技术能够将不同的层整合成一个文件系统，为这些层提供了一个统一的视角，这样就隐藏了多层的存在，在用户的角度看来，只存在一个文件系统</li>
<li>一个镜像可以放在另一个镜像的上面。<strong>位于下面的镜像称为父镜像，最底部的镜像成为基础镜像</strong></li>
<li>当从一个镜像启动容器时，Docker会在最顶层加载一个读写文件系统作为容器</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/image-20240317173646107.png" alt="image-20240317173646107" style="zoom:50%;"></p>
<p>思考：</p>
<p>1.Docker镜像本质是什么?</p>
<ul>
<li>是一个分层文件系统</li>
</ul>
<p>2.Docker中一个centos镜像为什么只有200MB，而一个centos操作系统的iso文件要几个G?</p>
<ul>
<li>Centos的iso镜像文件包含bootfs和rootfs，而docker的centos镜像复用操作系统的bootfs，只有rootfs和其他镜像层</li>
</ul>
<p>3.Docker中一个tomcat镜像为什么有500MB，而一个tomcat安装包只有70多MB?</p>
<ul>
<li>由于docker中镜像是分层的，tomcat虽然只有70多MB，但他需要依赖于父镜像和基础镜像，所有整个对外暴露的tomcat镜像大小500多MB</li>
</ul>
<h2 id="镜像制作">镜像制作</h2>
<p>Docker镜像如何制作？</p>
<p>1.容器转为镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker commit 容器id 镜像名称:版本号       #将容器转为新的镜像（不是目录挂载的都可以生效）</span><br><span class="line">docker save -o 压缩文件名称 镜像名称:版本号 #将新的镜像打包成压缩文件，进行传输</span><br><span class="line">docker load -i 压缩文件名称               #将压缩文件解压还原为镜像</span><br></pre></td></tr></table></figure>
<p>2.dockerfile</p>
<h2 id="dockerfile概念">Dockerfile概念</h2>
<ul>
<li>Dockerfile是一个文本文件</li>
<li>包含了一条条的指令</li>
<li>每一条指令构建一层，基于基础镜像，最终构建出一个新的镜像</li>
<li>对于开发人员：可以为开发团队提供一个完全一致的开发环境</li>
<li>对于测试人员：可以直接拿开发时所构建的镜像或者通过Dockerfile文件构建一个新的镜像开始工作了</li>
<li>对于运维人员：在部署时，可以实现应用的无缝移植</li>
</ul>
<p>Dochub网址：https://hub.docker.com</p>
<h3 id="关键字">关键字</h3>
<table>
<colgroup>
<col style="width: 11%">
<col style="width: 25%">
<col style="width: 63%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>关键字</strong></th>
<th style="text-align: left;"><strong>作用</strong></th>
<th style="text-align: left;"><strong>备注</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">FROM</td>
<td style="text-align: left;">指定父镜像</td>
<td style="text-align: left;">指定 dockerfile 基于那个 image 构建</td>
</tr>
<tr class="even">
<td style="text-align: left;">MAINTAINER</td>
<td style="text-align: left;">作者信息</td>
<td style="text-align: left;">用来标明这个 dockerfile 作者</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LABEL</td>
<td style="text-align: left;">标签</td>
<td style="text-align: left;">用来标明 dockerfile 的标签可以使用 Label
代码 Maintainer 最终都是在 docker image 基本信息中可以查看</td>
</tr>
<tr class="even">
<td style="text-align: left;">RUN</td>
<td style="text-align: left;">执行命令</td>
<td style="text-align: left;">执行一段命令默认是 /bin/sh 格式：RUN
command 或者 RUN [“command”,”param1”,”param2”]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CMD</td>
<td style="text-align: left;">容器启动命令</td>
<td style="text-align: left;">启动容器时候的默认命令和 ENTRYPOINT
配合使用 格式 CMD command param1 param2 或者 CMD
[“command”,”param1”,”param2”]</td>
</tr>
<tr class="even">
<td style="text-align: left;">COPY</td>
<td style="text-align: left;">复制文件</td>
<td style="text-align: left;">build 的时候复制文件到 image 中</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ADD</td>
<td style="text-align: left;">添加文件</td>
<td style="text-align: left;">build 的时候添加文件到 image 中
不仅仅局限于当前的 build 上下文 可以来源于远程服务</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENV</td>
<td style="text-align: left;">环境变量</td>
<td style="text-align: left;">指定 build
时候的环境变量可以在启动的容器的时候通过 - e 覆盖格式 ENV
name=value</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ARG</td>
<td style="text-align: left;">构建参数</td>
<td style="text-align: left;">构建参数 只在构建的时候使用的参数 如果有
ENV 那么 ENV 的相同名字的值始终覆盖 arg 的参数</td>
</tr>
<tr class="even">
<td style="text-align: left;">VOLUME</td>
<td style="text-align: left;">定义外部可以挂载的数据卷</td>
<td style="text-align: left;">指定 build 的 image
哪些目录可以启动的时候挂载到文件系统中 启动容器的时候使用 - v 绑定 格式
VOLUME [“目录”]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EXPOSE</td>
<td style="text-align: left;">暴露端口</td>
<td style="text-align: left;">定义容器运行的时候监听的端口
启动容器的时候使用 - p 来绑定暴露端口 格式： EXPOSE 8080 或者 EXPOSE
8080/udp</td>
</tr>
<tr class="even">
<td style="text-align: left;">WORKDIR</td>
<td style="text-align: left;">工作目录</td>
<td style="text-align: left;">指定容器内部的工作目录
如果没有创建则自动创建 如果指定 / 使用的是绝对地址 如果不是 / 开头
那么是在上一条 workdir 的路径的相对路径</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USER</td>
<td style="text-align: left;">指定执行用户</td>
<td style="text-align: left;">指定 build 或者启动的时候 用户在 RUN CMD
ENTRYPOINT 执行的时候的用户</td>
</tr>
<tr class="even">
<td style="text-align: left;">HEALTHCHECK</td>
<td style="text-align: left;">健康检查</td>
<td style="text-align: left;">指定检测当前容器健康监测的命令 基本上没用
因为很多时候应用本身有健康监测机制</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ONBUILD</td>
<td style="text-align: left;">触发器</td>
<td style="text-align: left;">当存在 ONBUILD
关键字的镜像作为基础镜像的时候 当执行 FROM 完成之后会执行 ONBUID 的命令
但是不影响当前镜像用处也不怎么大</td>
</tr>
<tr class="even">
<td style="text-align: left;">STOPSIGNAL</td>
<td style="text-align: left;">发送信号量到宿主机</td>
<td style="text-align: left;">该 STOPSIGNAL
指令设置将发送到容器的系统调用信号以退出</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SHELL</td>
<td style="text-align: left;">指定执行脚本的 shell</td>
<td style="text-align: left;">指定 RUN CMD ENTRYPOINT
执行命令的时候使用的 shell</td>
</tr>
</tbody>
</table>
<h1 id="docker服务编排">Docker服务编排</h1>
<p>微服务架构的应用系统中一般包含若干个微服务，每个微服务一般都会部署多个实例，如果每个微服务都要手动启停，维护的工作量会很大。</p>
<ul>
<li>要从Dockerfile build image 或者去 dockerhub 拉取image</li>
<li>要创建多个container</li>
<li>要管理这些container（启动停止删除）</li>
</ul>
<p><strong>服务编排</strong>：按照一定的业务规则批量管理容器</p>
<h2 id="docker-compose">Docker Compose</h2>
<p>Docker
Compose是一个编排多容器分布式部署的工具，提供命令集管理容器化应用的完整开发周期，包括服务构建，启动和停止。使用步骤：</p>
<ol type="1">
<li>利用Dockerfile定义运行环境镜像</li>
<li>使用 docker-compose.yml 定义组成应用的各服务</li>
<li>运行 docker-compose up 启动应用</li>
</ol>
<h3 id="安装docker-compose">安装Docker Compose</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Compose目前已经完全支持Linux、Mac Os和windows，在我们安装Compose之前，需要先安装Docker。下面我们以编译好的二进制包方式安装在Linux系统中</span></span><br><span class="line">curl -L https://github.com/docker/compose/releases/download/1.22.0/docker-compose-`uname-s`-`uname -m` -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置文件可执行权限</span></span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看版本信息</span></span><br><span class="line">docker-compose -version</span><br></pre></td></tr></table></figure>
<h3 id="卸载docker-compose">卸载Docker Compose</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">二进制包方式安装的，删除二进制文件即可</span></span><br><span class="line">rm /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
<h1 id="docker私有仓库">Docker私有仓库</h1>
<p>Docker官方的Dockerhub（https://hub.docker.com）是一个用于管理公共镜像的仓库，我们可以从上面拉取镜像到本地，也可以把我们自己的镜像推送上去。但是，有时候我们的服务器无法访问互联网，或者你不希望将自己的镜像放到公网当中，那么我们就需要搭建自己的私有仓库来存储和管理自己的镜像。</p>
<h2 id="私有仓库搭建">私有仓库搭建</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、拉取私有仓库镜像</span></span><br><span class="line">docker pull registry</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、启动私有仓库容器</span></span><br><span class="line">docker run -id --name=registry -p 5000:5000 registry</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3、打开浏览器输入地址http://私有仓库服务器ip:5000/v2/_catalog，看到&#123;<span class="string">&quot;repositories&quot;</span>:[]&#125;表示私有仓库搭建成功</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4、修改daemon.json</span></span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在上述文件中添加一个key，保存退出。此步用于让docker信任私有仓库地址；注意将私有仓库服务器ip修改为自己私有仓库服务器真实ip</span></span><br><span class="line">&#123;&quot;insecure-registries&quot;: [&quot;私有仓库服务器ip:5000&quot;]&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">5、重启docker服务</span></span><br><span class="line">systemctl restart docker</span><br><span class="line">docker start registry</span><br></pre></td></tr></table></figure>
<h2 id="将镜像上传至私有仓库">将镜像上传至私有仓库</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1、标记镜像为私有仓库的镜像</span></span><br><span class="line">docker tag centos:7 私有仓库服务器IP:5000/centos:7</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2、上传标记的镜像</span></span><br><span class="line">docker push 私有仓库服务器IP:5000/centos:7</span><br></pre></td></tr></table></figure>
<h2 id="从私有仓库拉取镜像">从私有仓库拉取镜像</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">拉取镜像</span></span><br><span class="line">docker pu11 私有仓库服务器ip:5000/centos:7</span><br></pre></td></tr></table></figure>
<h1 id="docker容器虚拟化与传统虚拟机比较">docker容器虚拟化与传统虚拟机比较</h1>
<p>容器就是将软件打包成标准化单元，以用于开发、交付和部署。</p>
<ul>
<li>容器镜像是轻量的、可执行的独立软件包，包含软件运行所需的所有内容：代码、运行时环境、系统工具、系统库和设置。</li>
<li>容器化软件在任何环境中都能够始终如一地运行。</li>
<li>容器赋予了软件独立性，使其免受外在环境差异的影响，从而有助于减少团队间在相同基础设施上运行不同软件时的冲突。</li>
</ul>
<p>相同：</p>
<ul>
<li>容器和虚拟机具有相似的资源隔离和分配优势</li>
</ul>
<p>不同：</p>
<ul>
<li>容器虚拟化的是操作系统，虚拟机虚拟化的是硬件</li>
<li>传统虚拟机可以运行不同的操作系统，容器只能运行同一类型操作系统</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/image-20240317213232568.png" alt="image-20240317213232568" style="zoom: 50%;"></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">特性</th>
<th style="text-align: left;">容器</th>
<th>虚拟机</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">启动</td>
<td style="text-align: left;">秒级</td>
<td>分钟级</td>
</tr>
<tr class="even">
<td style="text-align: left;">硬盘使用</td>
<td style="text-align: left;">一般为MB</td>
<td>一般为GB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">性能</td>
<td style="text-align: left;">接近原生</td>
<td>弱于</td>
</tr>
<tr class="even">
<td style="text-align: left;">系统支持量</td>
<td style="text-align: left;">单机支持上千个容器</td>
<td>一般几十个</td>
</tr>
</tbody>
</table>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">久朝暮</div><div class="post-copyright__author_desc">紫气东来</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://gaoyubo.cn/blogs/f255ffad.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://gaoyubo.cn/blogs/f255ffad.html')">docker</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://gaoyubo.cn/blogs/f255ffad.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=docker&amp;url=https://gaoyubo.cn/blogs/f255ffad.html&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gaoyubo.cn" target="_blank">久朝暮</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/docker/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>docker<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/blogs/5cd16023.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">高级AI复习</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2021/01/15/7dbc6721bad89.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">开发、算法、课程总结</b>相关的内容，还有<b style="color:#fff">个人生活</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">久朝暮</h1><div class="author-info__desc">紫气东来</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/zy-zy9" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/479202769" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/%E5%BE%AE%E4%BF%A1%E6%90%9C%E4%B8%80%E6%90%9C.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/%E5%BE%AE%E4%BF%A1%E6%90%9C%E4%B8%80%E6%90%9Cback.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9D%E5%A7%8Bdocker"><span class="toc-number">1.</span> <span class="toc-text">初始Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">Docker概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85docker"><span class="toc-number">1.2.</span> <span class="toc-text">安装Docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-%E6%9E%B6%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text">Docker 架构</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E5%91%BD%E4%BB%A4"><span class="toc-number">2.</span> <span class="toc-text">Docker命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E6%9C%8D%E5%8A%A1%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">2.1.</span> <span class="toc-text">Docker服务相关命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E9%95%9C%E5%83%8F%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">2.2.</span> <span class="toc-text">Docker镜像相关命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E5%AE%B9%E5%99%A8%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-number">2.3.</span> <span class="toc-text">Docker容器相关命令</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E5%AE%B9%E5%99%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">3.</span> <span class="toc-text">Docker容器的数据卷</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E6%A6%82%E5%BF%B5"><span class="toc-number">3.1.</span> <span class="toc-text">数据卷概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">3.1.1.</span> <span class="toc-text">数据卷</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E4%BD%9C%E7%94%A8"><span class="toc-number">3.1.2.</span> <span class="toc-text">数据卷作用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="toc-number">3.2.</span> <span class="toc-text">配置数据卷</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="toc-number">3.3.</span> <span class="toc-text">数据卷容器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"><span class="toc-number">3.3.1.</span> <span class="toc-text">配置数据卷容器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E5%BA%94%E7%94%A8%E9%83%A8%E7%BD%B2"><span class="toc-number">4.</span> <span class="toc-text">Docker应用部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E9%83%A8%E7%BD%B2"><span class="toc-number">4.1.</span> <span class="toc-text">MySQL部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tomcat%E9%83%A8%E7%BD%B2"><span class="toc-number">4.2.</span> <span class="toc-text">Tomcat部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx%E9%83%A8%E7%BD%B2"><span class="toc-number">4.3.</span> <span class="toc-text">Nginx部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis%E9%83%A8%E7%BD%B2"><span class="toc-number">4.4.</span> <span class="toc-text">Redis部署</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dockerfile"><span class="toc-number">5.</span> <span class="toc-text">Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E9%95%9C%E5%83%8F%E5%8E%9F%E7%90%86"><span class="toc-number">5.1.</span> <span class="toc-text">Docker镜像原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C"><span class="toc-number">5.2.</span> <span class="toc-text">镜像制作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dockerfile%E6%A6%82%E5%BF%B5"><span class="toc-number">5.3.</span> <span class="toc-text">Dockerfile概念</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">5.3.1.</span> <span class="toc-text">关键字</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E6%9C%8D%E5%8A%A1%E7%BC%96%E6%8E%92"><span class="toc-number">6.</span> <span class="toc-text">Docker服务编排</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-compose"><span class="toc-number">6.1.</span> <span class="toc-text">Docker Compose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85docker-compose"><span class="toc-number">6.1.1.</span> <span class="toc-text">安装Docker Compose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B8%E8%BD%BDdocker-compose"><span class="toc-number">6.1.2.</span> <span class="toc-text">卸载Docker Compose</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93"><span class="toc-number">7.</span> <span class="toc-text">Docker私有仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA"><span class="toc-number">7.1.</span> <span class="toc-text">私有仓库搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%86%E9%95%9C%E5%83%8F%E4%B8%8A%E4%BC%A0%E8%87%B3%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93"><span class="toc-number">7.2.</span> <span class="toc-text">将镜像上传至私有仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-number">7.3.</span> <span class="toc-text">从私有仓库拉取镜像</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E5%AE%B9%E5%99%A8%E8%99%9A%E6%8B%9F%E5%8C%96%E4%B8%8E%E4%BC%A0%E7%BB%9F%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%AF%94%E8%BE%83"><span class="toc-number">8.</span> <span class="toc-text">docker容器虚拟化与传统虚拟机比较</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/blogs/f255ffad.html" title="docker">docker</a><time datetime="2024-03-16T03:11:46.000Z" title="发表于 2024-03-16 11:11:46">2024-03-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/blogs/5cd16023.html" title="高级AI复习">高级AI复习</a><time datetime="2024-01-18T05:41:14.000Z" title="发表于 2024-01-18 13:41:14">2024-01-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/blogs/b831931c.html" title="体系结构总结">体系结构总结</a><time datetime="2024-01-15T06:14:11.000Z" title="发表于 2024-01-15 14:14:11">2024-01-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/blogs/9a8cdc59.html" title="计算机网络复习">计算机网络复习</a><time datetime="2024-01-05T13:36:41.000Z" title="发表于 2024-01-05 21:36:41">2024-01-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/blogs/6fbd99c.html" title="操作系统高级教程思考题">操作系统高级教程思考题</a><time datetime="2023-12-14T14:46:27.000Z" title="发表于 2023-12-14 22:46:27">2023-12-14</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="/wzy2096@126.com" title="Email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/zy-zy9" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://picyuan-1321960394.cos.ap-beijing.myqcloud.com/eh.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/479202769" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.douyin.com/user/self" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a></div><div class="copyright">&copy;2020 - 2024 By 久朝暮</div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">11</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">4</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/album/"><span> 相册</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/C-STL/" style="font-size: 0.88rem;">C++ STL<sup>1</sup></a><a href="/tags/C-2-0/" style="font-size: 0.88rem;">C++2.0<sup>1</sup></a><a href="/tags/C-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 0.88rem;">C++内存管理<sup>1</sup></a><a href="/tags/C-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 0.88rem;">C++设计模式<sup>1</sup></a><a href="/tags/C-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B/" style="font-size: 0.88rem;">C++面向对象高级编程<sup>1</sup></a><a href="/tags/Effective-C/" style="font-size: 0.88rem;">Effective C++<sup>1</sup></a><a href="/tags/Linux%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/" style="font-size: 0.88rem;">Linux常用函数<sup>1</sup></a><a href="/tags/Linux%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4/" style="font-size: 0.88rem;">Linux系统命令<sup>1</sup></a><a href="/tags/UCAS%E8%AF%BE%E7%A8%8B/" style="font-size: 0.88rem;">UCAS课程<sup>4</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>1</sup></a><a href="/tags/%E7%A7%BB%E5%8A%A8%E4%BA%92%E8%BF%9E%E7%BD%91%E6%8A%80%E6%9C%AF/" style="font-size: 0.88rem;">移动互连网技术<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.cbd.int/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><script>(() => {
  const initValine = () => {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'Tt2yKI8TpkxMniyxFfGh8FX6-gzGzoHsz',
      appKey: '5oQifQ5aHzJHGp2AUh22jSe3',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  const loadValine = async () => {
    if (typeof Valine === 'function') initValine()
    else {
      await getScript('https://cdn.cbd.int/valine@1.5.1/dist/Valine.min.js')
      initValine()
    }
  }

  if ('Valine' === 'Valine' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>